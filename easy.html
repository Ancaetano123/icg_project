<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="road_rumble.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Road Rumble - Easy</title>
    <link href="https://fonts.googleapis.com/css?family=Press+Start+2P" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <div id="preloader">
      <h1>Loading...</h1>
    </div>
    <div id="game-container" style="position:relative; width:100vw; height:100vh;">
      <canvas class="game"></canvas>
      <div id="controls">
        <p>Use W, A, S, D to move and Space to jump over obstacles!</p>
      </div>
      <div id="score" style="display:none"></div>
      <div id="result-container" style="display: none; visibility: hidden; position: fixed; left: 50%; top: 50%; transform: translate(-50%, -50%); background: #000; border: 4px solid #fff; border-radius: 18px; box-shadow: 0 8px 32px rgba(0,0,0,0.45); padding: 10px 24px 18px 24px; z-index: 1000; min-width: 160px; min-height: 0;">
        <div id="result" style="display: flex; flex-direction: column; align-items: center;">
          <h1 class="pixel-title" style="font-size:2em;margin-top:10px;margin-bottom:18px;color:#e53935;text-align:center;letter-spacing:2px;">GAME OVER</h1>
          <p class="final-score-label" style="color:#fff;font-size:1em;text-align:center;">Final Score:</p>
          <div id="final-score" class="final-score-value" style="color:#fff;font-size:1.2em;text-align:center;margin-bottom:12px;"></div>
          <div class="pixel-btn-row" style="display:flex;gap:12px;justify-content:center;">
            <button id="retry" class="pixel-btn pixel-green" style="background:#43a047;color:#fff;border-bottom:4px solid #2e7031;">Play Again</button>
            <button id="back" class="pixel-btn pixel-red">Exit</button>
          </div>
          <!-- Botão Revive, oculto por padrão -->
          <button id="revive" class="pixel-btn pixel-pink" style="display:none;margin-top:18px;background:#ff4081;color:#fff;border-bottom:4px solid #c2185b;">Revive</button>
        </div>
      </div>

      <!-- Overlay de início removido -->
      <!-- Texto de instruções fixo no fundo removido -->
    </div>
    <!-- Adiciona o import do Three.js via CDN -->
    <script type="module">
      import * as THREE from "https://unpkg.com/three@0.150.1/build/three.module.js";
      window.THREE = THREE;
    </script>
    <script type="module" src="src/main_easy.js"></script>
    <script>
      window.addEventListener("load", () => {
        document.getElementById("preloader").style.display = "none";
        document.getElementById("game-container").style.display = "block";
      });

      document.getElementById("retry").addEventListener("click", () => {
        // Mostra o preloader antes de recarregar
        document.getElementById("preloader").style.display = "flex";
        document.getElementById("game-container").style.display = "none";
        setTimeout(() => {
          location.reload();
        }, 200); // Pequeno delay para garantir que o preloader aparece
      });

      document.getElementById("back").addEventListener("click", () => {
        window.location.href = "index.html";
      });

      function showStartOverlay() {
        const overlay = document.getElementById("start-overlay");
        overlay.style.visibility = "visible";
        overlay.style.opacity = "1";
        setTimeout(() => {
          overlay.style.opacity = "0";
          setTimeout(() => {
            overlay.style.visibility = "hidden";
          }, 500);
        }, 1000);
      }

      // Shows the result-container only on game over
      window.showGameOverScreen = function() {
        const result = document.getElementById("result-container");
        if (result) {
          result.style.display = "flex";
          result.style.visibility = "visible";
        }
      };
      window.hideGameOverScreen = function() {
        const result = document.getElementById("result-container");
        if (result) {
          result.style.display = "none";
          result.style.visibility = "hidden";
        }
      };

      // Exemplo de como mostrar o botão revive via JS:
      // document.getElementById("revive").style.display = "block";
    </script>
  </body>
</html>
